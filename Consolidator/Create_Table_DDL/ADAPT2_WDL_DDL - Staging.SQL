USE DATABASE wholesale_dev;
USE SCHEMA userdb_etl_confidential;
CREATE OR REPLACE TABLE ADAPT2_A2_AWARDS_STG (
AWARD_ID NUMBER(38,2),
BID_ID VARCHAR(50),
SCHED_BID_ID VARCHAR(50),
ISO VARCHAR(50),
PARTICIPANT VARCHAR(50),
SUB_PARTICIPANT VARCHAR(50),
OPERATING_DATE TIMESTAMP_LTZ,
OPERATING_HOUR NUMBER(38,2),
OPERATING_INTERVAL NUMBER(38,2),
MARKET_TYPE VARCHAR(50),
AWARD_TYPE VARCHAR(50),
PRODUCT VARCHAR(50),
SUB_PRODUCT VARCHAR(50),
TRADE_TYPE VARCHAR(50),
SETTLEMENT_POINT VARCHAR(50),
SETTLEMENT_NODE_ID NUMBER(38,2),
SINK_POINT VARCHAR(50),
SINK_NODE_ID VARCHAR(50),
MW NUMBER(38,2),
PRICE NUMBER(38,2),
SINK_PRICE VARCHAR(50),
TRADER VARCHAR(50),
STRATEGY VARCHAR(50),
BUYER VARCHAR(50),
SELLER VARCHAR(50),
ISO_STATUS VARCHAR(50),
SOURCE VARCHAR(50),
FILE_SOURCE VARCHAR(50),
STATUS VARCHAR(50),
VERSION VARCHAR(50),
MODIFY_DATE TIMESTAMP_LTZ,
MODIFY_USER VARCHAR(50),
DWH_CREATION_TIME TIMESTAMP_NTZ,
DWH_CREATION_USER  VARCHAR(50),
DWH_UPDATED_TIME TIMESTAMP_NTZ,
DWH_UPDATED_USER  VARCHAR(50),
SOURCE_SYSTEM_KEY  NUMBER(38,2)
);

CREATE OR REPLACE TABLE ADAPT2_NYISO_DSS_HR_LSE_LBMP_ENERGY_STG (
ORG_NAME VARCHAR(50),
LSE_NAME VARCHAR(50),
BUS_NAME VARCHAR(50),
OPERATING_DATE TIMESTAMP_LTZ,
OPERATING_HOUR NUMBER(38,2),
BILLING_CODE NUMBER(38,2),
NAME VARCHAR(50),
VALUE NUMBER(38,2),
VERSION NUMBER(38,2),
SOURCE VARCHAR(50),
MODIFY_DATE TIMESTAMP_LTZ,
MODIFY_USER VARCHAR(50),
DWH_CREATION_TIME TIMESTAMP_NTZ,
DWH_CREATION_USER  VARCHAR(50),
DWH_UPDATED_TIME TIMESTAMP_NTZ,
DWH_UPDATED_USER  VARCHAR(50),
SOURCE_SYSTEM_KEY  NUMBER(38,2)
);

CREATE OR REPLACE TABLE ADAPT2_MISO_AO_DETERMINANTS_HOURLY_STG (
ASSET_OWNER_NAME VARCHAR(50),
SCHEDULED_DATE TIMESTAMP_LTZ,
OPERATING_DATE TIMESTAMP_LTZ,
STATEMENT_ID VARCHAR(50),
ASSET_NM VARCHAR(50),
ASSET_TYP VARCHAR(50),
DET_TYP_ID VARCHAR(50),
DET_TYP_NM VARCHAR(50),
ZN_ID VARCHAR(50),
ND_ID VARCHAR(50),
CONSTRAINT_NAME VARCHAR(50),
OPERATING_HOUR NUMBER(38,2),
VAL NUMBER(38,2),
VERSION VARCHAR(50),
SOURCE VARCHAR(50),
MODIFY_DATE TIMESTAMP_LTZ,
MODIFY_USER VARCHAR(50),
DEL_ND_ID VARCHAR(50),
SNK_ND_ID VARCHAR(50),
TXN_TYP VARCHAR(50),
LRZ VARCHAR(50),
SRC_ND_ID VARCHAR(50),
DWH_CREATION_TIME TIMESTAMP_NTZ,
DWH_CREATION_USER  VARCHAR(50),
DWH_UPDATED_TIME TIMESTAMP_NTZ,
DWH_UPDATED_USER  VARCHAR(50),
SOURCE_SYSTEM_KEY  NUMBER(38,2)
);

CREATE OR REPLACE TABLE ADAPT2_PJM_MSRS_ENERGY_MKT_CONG_LOSS_CH_SUB_STG (
CUSTOMER_ACCOUNT VARCHAR(50),
CUSTOMER_ID NUMBER(38,2),
CUSTOMER_CODE VARCHAR(50),
OPERATING_DATE TIMESTAMP_LTZ,
OPERATING_HOUR NUMBER(38,2),
OPERATING_INTERVAL NUMBER(38,2),
GMT_INTERVAL_ENDING VARCHAR(50),
PNODE_NAME VARCHAR(50),
PNODE_ID NUMBER(38,2),
DA_PJM_ENERGY_PRICE NUMBER(38,2),
DA_ENERGY_WITHDRAWAL_MW NUMBER(38,2),
DA_WITHDRAWAL_ENERGY_CHARGE NUMBER(38,2),
DA_ENERGY_INJECTION_MW NUMBER(38,2),
DA_ENERGY_INJECTION_CREDIT NUMBER(38,2),
DA_SPOT_MARKET_ENERGY_CHARGE NUMBER(38,2),
PNODE_DA_CONGESTION_PRICE NUMBER(38,2),
DA_CONGESTION_WITHDRAWAL_MW NUMBER(38,2),
DA_CONGESTION_WITHDRAWAL_CHARGE NUMBER(38,2),
DA_CONGESTION_INJECTION_MW NUMBER(38,2),
DA_CONGESTION_INJECTION_CREDIT NUMBER(38,2),
DA_IMPLICIT_CONGESTION_CHARGE NUMBER(38,2),
PNODE_DA_LOSS_PRICE NUMBER(38,2),
DA_LOSS_WITHDRAWAL_MW NUMBER(38,2),
DA_LOSS_WITHDRAWAL_CHARGE NUMBER(38,2),
DA_LOSS_INJECTION_MW NUMBER(38,2),
DA_LOSS_INJECTION_CREDIT NUMBER(38,2),
DA_IMPLICIT_LOSS_CHARGE NUMBER(38,2),
RT_PJM_ENERGY_PRICE NUMBER(38,2),
RT_ENERGY_WITHDRAWAL_MW NUMBER(38,2),
BAL_ENERGY_WITHDRAWAL_DEVIATION_MW NUMBER(38,2),
BAL_ENERGY_WITHDRAWAL_CHARGE NUMBER(38,2),
RT_ENERGY_INJECTION_MW NUMBER(38,2),
BAL_ENERGY_INJECTION_DEVIATION_MW NUMBER(38,2),
BAL_ENERGY_INJECTION_CREDIT NUMBER(38,2),
BAL_SPOT_MARKET_ENERGY_CHARGE NUMBER(38,2),
PNODE_RT_CONGESTION_PRICE NUMBER(38,2),
RT_CONGESTION_WITHDRAWAL_MW NUMBER(38,2),
BAL_CONGESTION_WITHDRAWAL_DEVIATION_MW NUMBER(38,2),
BAL_CONGESTION_WITHDRAWAL_CHARGE NUMBER(38,2),
RT_CONGESTION_INJECTION_MW NUMBER(38,2),
BAL_CONGESTION_INJECTION_DEVIATION_MW NUMBER(38,2),
BAL_CONGESTION_INJECTION_CREDIT NUMBER(38,2),
BAL_IMPLICIT_CONGESTION_CHARGE NUMBER(38,2),
PNODE_RT_LOSS_PRICE NUMBER(38,2),
RT_LOSS_WITHDRAWAL_MW NUMBER(38,2),
BAL_LOSS_WITHDRAWAL_DEVIATION_MW NUMBER(38,2),
BAL_LOSS_WITHDRAWAL_CHARGE NUMBER(38,2),
RT_LOSS_INJECTION_MW NUMBER(38,2),
BAL_LOSS_INJECTION_DEVIATION_MW NUMBER(38,2),
BAL_LOSS_INJECTION_CREDIT NUMBER(38,2),
BAL_IMPLICIT_LOSS_CHARGE NUMBER(38,2),
VERSION VARCHAR(50),
SOURCE VARCHAR(50),
MODIFY_DATE TIMESTAMP_LTZ,
MODIFY_USER VARCHAR(50),
DWH_CREATION_TIME TIMESTAMP_LTZ,
DWH_CREATION_USER  VARCHAR(50),
DWH_UPDATED_TIME TIMESTAMP_NTZ,
DWH_UPDATED_USER  VARCHAR(50),
SOURCE_SYSTEM_KEY  NUMBER(38,2)
);

CREATE OR REPLACE TABLE ADAPT2_ISONE_MIS_DALOCSUM_SUBACCT_STG (
PARTICIPANT VARCHAR(50),
OPERATING_DATE VARCHAR(50),
OPERATING_HOUR NUMBER(38,2),
SUB_ACCT_ID VARCHAR(50),
SUB_ACCT_NAME VARCHAR(50),
LOCATION_ID NUMBER(38,2),
LOCATION_NAME VARCHAR(50),
LOCATION_TYPE VARCHAR(50),
DA_CLEARED_GEN NUMBER(38,2),
DA_CLEARED_INC NUMBER(38,2),
DA_CLEARED_IMPORTS NUMBER(38,2),
DA_GEN_OBL NUMBER(38,2),
DA_CLEARED_DEM_BIDS NUMBER(38,2),
DA_CLEARED_DEC NUMBER(38,2),
DA_CLEARED_EXPORTS NUMBER(38,2),
DA_LOAD_OBL NUMBER(38,2),
DA_IBM_PUR NUMBER(38,2),
DA_IBM_SALES NUMBER(38,2),
DA_ADJ_LOAD_OBL NUMBER(38,2),
DA_ADJ_NET_INTERCHANGE NUMBER(38,2),
DA_ENERGY_COMP NUMBER(38,2),
DA_CONG_COMP NUMBER(38,2),
DA_MARGINAL_LOSS_COMP NUMBER(38,2),
DA_ENERGY_CH_CR NUMBER(38,2),
DA_CONG_CH_CR NUMBER(38,2),
DA_LOSS_CH_CR NUMBER(38,2),
DA_CLEARED_ASSET_DEM_BIDS NUMBER(38,2),
VERSION VARCHAR(50),
SOURCE VARCHAR(50),
MODIFY_DATE VARCHAR(50),
MODIFY_USER VARCHAR(50),
DA_LOAD_OBL_CH_ALL NUMBER(38,2),
DA_DEM_RED NUMBER(38,2),
DA_DEM_RED_OBL NUMBER(38,2),
DWH_CREATION_TIME TIMESTAMP_NTZ,
DWH_CREATION_USER  VARCHAR(50),
DWH_UPDATED_TIME TIMESTAMP_NTZ,
DWH_UPDATED_USER  VARCHAR(50),
SOURCE_SYSTEM_KEY  NUMBER(38,2)
);

CREATE OR REPLACE TABLE ADAPT2_ISONE_MIS_RTLOCSUM_SUBACCT_STG (
PARTICIPANT NUMBER(38,2),
OPERATING_DATE TIMESTAMP_LTZ,
OPERATING_HOUR NUMBER(38,2),
SUB_ACCT_ID NUMBER(38,2),
SUB_ACCT_NAME VARCHAR(50),
LOCATION_ID NUMBER(38,2),
LOCATION_NAME VARCHAR(50),
LOCATION_TYPE VARCHAR(50),
REV_METERED_GEN NUMBER(38,2),
SCHED_IMPORTS VARCHAR(50),
RT_GEN_OBL NUMBER(38,2),
REV_METERED_LOAD NUMBER(38,2),
SCHED_EXPORTS VARCHAR(50),
IBM_LOAD VARCHAR(50),
RT_LOAD_OBL NUMBER(38,2),
RT_IBM_PUR VARCHAR(50),
RT_IBM_SALES VARCHAR(50),
RT_ADJ_OBL VARCHAR(50),
RT_ADJ_INTERCHANGE VARCHAR(50),
ADJ_NET_INTERCHANGE_DEV NUMBER(38,2),
RT_ENERGY_COMP VARCHAR(50),
RT_CONG_COMP VARCHAR(50),
RT_MARGINAL_LOSS_COMP VARCHAR(50),
RT_ENERGY_CH_CR VARCHAR(50),
RT_CONG_CH_CR VARCHAR(50),
RT_LOSS_CH_CR VARCHAR(50),
RT_IBM_PUR_IMPACTING_MLRLO VARCHAR(50),
RT_IBM_SALES_IMPACTING_MLRLO VARCHAR(50),
MARGINAL_LOSS_REV_LOAD_OBL VARCHAR(50),
VERSION VARCHAR(50),
SOURCE VARCHAR(50),
MODIFY_DATE VARCHAR(50),
MODIFY_USER VARCHAR(50),
RT_GEN_OBL_CH_ALLOC VARCHAR(50),
RT_LOAD_OBL_CH_ALLOC VARCHAR(50),
RT_ADJ_NET_INTERCHANGE_CH_ALLOC VARCHAR(50),
RT_DEM_REDUCTION_OBL VARCHAR(50),
RT_LOAD_OBL_DEM_REDUCTION_ALLOC VARCHAR(50),
DEM_REDUCTION_OBL_DEV VARCHAR(50),
RT_DEMAND_RED_CRED VARCHAR(50),
RT_DEMAND_RED_CH VARCHAR(50),
DWH_CREATION_TIME TIMESTAMP_NTZ,
DWH_CREATION_USER  VARCHAR(50),
DWH_UPDATED_TIME TIMESTAMP_NTZ,
DWH_UPDATED_USER  VARCHAR(50),
SOURCE_SYSTEM_KEY  NUMBER(38,2)
);

